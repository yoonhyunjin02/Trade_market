<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Search</title>
    <link rel="stylesheet" th:href="@{/css/common/common.css}">
    <link rel="stylesheet" th:href="@{/css/common/header.css}">
    <link rel="stylesheet" th:href="@{/css/common/footer.css}">
    <link rel="stylesheet" th:href="@{/css/common/product-card.css}">

    <link rel="stylesheet" th:href="@{/css/pages/search.css}">
</head>
<body>

<!-- Header Fragment -->
<header th:replace="fragments/header :: header"></header>

<main>
    <!-- Search Result Section -->
    <section class="search-results">
        <p th:if="${#lists.isEmpty(products)}" class="no-result-message">검색 결과가 없습니다.</p>

        <div class="item-grid">
            <div th:each="product : ${products}"
                 th:include="fragments/product-card :: productCard(${product})">
            </div>
        </div>
    </section>

    <!-- Pagination Section -->
    <nav class="pagination"
         th:if="${page != null && page.totalPages > 1}">

        <!-- 이전 버튼 (항상 표시하되 이동 가능 여부에 따라 스타일 변경) -->
        <a th:href="@{'/products/search'(keyword=${keyword}, categoryId=${categoryId}, page=${page.number - 1})}"
           th:class="'page-btn prev' + (${page.hasPrevious()} ? ' active' : ' disabled')">
            <img src="/images/icons/arrow.svg" alt="이전" class="flip-horizontal">
        </a>

        <!-- 현재 페이지 입력창 -->
        <form id="pageForm" onsubmit="return goToPageInput()">
            <input type="number"
                   id="pageInput"
                   name="pageInput"
                   min="1"
                   th:attr="max=${page.totalPages}"
                   th:value="${page.number + 1}">
            / <span th:text="${page.totalPages}">1</span>
        </form>

        <!-- 다음 버튼 (항상 표시하되 이동 가능 여부에 따라 스타일 변경) -->
        <a th:href="@{'/products/search'(keyword=${keyword}, categoryId=${categoryId}, page=${page.number + 1})}"
           th:class="'page-btn next' + (${page.hasNext()} ? ' active' : ' disabled')">
            <img src="/images/icons/arrow.svg" alt="다음">
        </a>
    </nav>
</main>

<!-- Footer Fragment -->
<footer th:replace="fragments/footer :: footer"></footer>

<script src="/js/common/header.js"></script>
<script src="/js/common/footer.js"></script>
<script src="/js/common/product-card.js"></script>

<script src="/js/pages/search.js"></script>
</body>
</html>