<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="fragments/head :: common-head(${productId} != null ? 'ÏÉÅÌíà ÏàòÏ†ï' : 'ÏÉÅÌíà Îì±Î°ù')"></th:block>
    <link rel="stylesheet" th:href="@{/css/pages/write.css}">
</head>
<body>
<!--* Í≥µÌÜµ Ìó§Îçî *-->
<div th:replace="~{fragments/header :: common-header}"></div>

<main>
    <section class="write-section">
        <div class="write-container">
            <!-- ÏÉÅÌíà Îì±Î°ù/ÏàòÏ†ï Ìèº -->
            <form th:action="@{${productId != null} ? '/products/' + productId + '/edit' : '/products/new'}"
                  method="post"
                  enctype="multipart/form-data"
                  th:object="${productDto}"
                  class="write-form">

                <!-- ÏÉÅÎã® ÏòÅÏó≠: Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú + Ï†úÎ™© + Í∞ÄÍ≤© -->
                <div class="top-section">
                    <!-- Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú ÏòÅÏó≠ -->
                    <div class="image-upload-section">
                        <div class="image-upload-area" id="imageUploadArea">
                            <div class="upload-placeholder" id="uploadPlaceholder">
                                <div class="camera-icon">üì∑</div>
                            </div>
                            <img id="previewImage" class="preview-image" style="display: none;">
                        </div>
                        <div class="file-name-display" id="fileNameDisplay">ÌååÏùº ÏÑ†ÌÉù</div>
                    </div>

                    <!-- Ïã§Ï†ú ÌååÏùº ÏóÖÎ°úÎìú ÌïÑÎìú -->
                    <input type="file"
                           name="imageFile"
                           accept="image/*"
                           class="hidden-file-input"
                           id="hiddenFileInput">

                    <!-- Ï†úÎ™© + Í∞ÄÍ≤© ÏòÅÏó≠ -->
                    <div class="title-price-section">
                        <!-- Í∏Ä Ï†úÎ™© -->
                        <div class="form-group">
                            <label for="title">Í∏Ä Ï†úÎ™©</label>
                            <input type="text"
                                   id="title"
                                   th:field="*{title}"
                                   th:classappend="${#fields.hasErrors('title') ? 'error' : ''}"
                                   placeholder="Í∏Ä Ï†úÎ™©"
                                   maxlength="100">
                            <div class="error-message"
                                 th:if="${#fields.hasErrors('title')}"
                                 th:errors="*{title}"></div>
                        </div>

                        <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ -->
                        <div class="form-group">
                            <label for="categoryName">Ïπ¥ÌÖåÍ≥†Î¶¨</label>

                            <select id="categoryName"
                                    name="categoryName"
                                    th:classappend="${#fields.hasErrors('categoryName') ? 'error' : ''}">

                                <!-- ‚úÖ placeholder (Í∏∞Î≥∏ ÏÑ†ÌÉùÎê®) -->
                                <option value=""
                                        th:selected="${#strings.isEmpty(productDto.categoryName)}"
                                        disabled>Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</option>

                                <!-- ‚úÖ DBÏóêÏÑú ÎÑòÏñ¥Ïò® Ïπ¥ÌÖåÍ≥†Î¶¨ Î™©Î°ù -->
                                <option th:each="category : ${categories}"
                                        th:value="${category.name}"
                                        th:text="${category.name}"
                                        th:selected="${productDto.categoryName != null and category.name == productDto.categoryName}">
                                </option>
                            </select>

                            <!-- ‚úÖ ÏóêÎü¨ Î©îÏãúÏßÄ -->
                            <div class="error-message"
                                 th:if="${#fields.hasErrors('categoryName')}"
                                 th:errors="*{categoryName}"></div>
                        </div>

                        <!-- Í∞ÄÍ≤© -->
                        <div class="form-group">
                            <label for="price">Í∞ÄÍ≤©</label>
                            <input type="text"
                                   id="price"
                                   th:field="*{price}"
                                   th:classappend="${#fields.hasErrors('price') ? 'error' : ''}"
                                   placeholder="Í∞ÄÍ≤©"
                                   maxlength="15">
                            <div class="error-message"
                                 th:if="${#fields.hasErrors('price')}"
                                 th:errors="*{price}"></div>
                        </div>
                    </div>
                </div>

                <!-- ÏÉÅÌíà ÏÑ§Î™Ö -->
                <div class="form-group">
                    <label for="description">Î¨ºÌíà ÏÑ§Î™Ö</label>
                    <textarea id="description"
                              th:field="*{description}"
                              th:classappend="${#fields.hasErrors('description') ? 'error' : ''}"
                              placeholder="Í≤åÏãúÍ∏Ä ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî."
                              rows="10"></textarea>
                    <div class="error-message"
                         th:if="${#fields.hasErrors('description')}"
                         th:errors="*{description}"></div>
                </div>

                <!-- Í±∞Îûò Ìù¨Îßù Ïû•ÏÜå -->
                <div class="form-group">
                    <label for="location">Í±∞Îûò Ìù¨Îßù Ïû•ÏÜå</label>
                    <input type="text"
                           id="location"
                           th:field="*{location}"
                           placeholder="Í±∞ÎûòÎ•º Ìù¨ÎßùÌïòÎäî Ïû•ÏÜå">
                </div>
                <div id="map" class="map-placeholder">ÏßÄÎèÑ</div>

                <!-- Ï†úÏ∂ú Î≤ÑÌäº -->
                <button type="submit" class="btn-submit">
                    ÏôÑÎ£å
                </button>

            </form>
        </div>
    </section>
</main>

<!--* Í≥µÌÜµ Ìë∏ÌÑ∞ *-->
<div th:replace="~{fragments/footer :: common-footer}"></div>

<script th:inline="javascript">
    const googleMapsApiKey = /*[[${googleMapsApiKey}]]*/ "";
</script>
<script src="/js/pages/write.js"></script>

</body>
</html>