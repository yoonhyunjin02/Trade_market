<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <th:block th:replace="fragments/head :: common-head('프로필')"></th:block>
  <link rel="stylesheet" th:href="@{/css/pages/profile.css}">
</head>
<body>
<!--* 공통 헤더 *-->
<div th:replace="~{fragments/header :: common-header}"></div>

<main>
  <section class="profile-section">
    <div class="profile-container">
      <!-- 프로필 헤더 -->
      <div class="profile-header">
        <div class="profile-info">
          <h1 th:text="${user.userName}">사용자명</h1>
          <p class="profile-id" th:text="${user.userId}">@userId</p>
          <p class="profile-location" th:if="${user.userLocation}" th:text="${user.userLocation}">위치정보</p>

          <!-- 매너온도 -->
          <div class="manner-temp">
            <span class="temp-label">매너온도</span>
            <div class="temp-bar">
              <div class="temp-fill" th:style="'width: ' + ${(userDetails.mannerTemperature - 0) / 100 * 100} + '%'"></div>
            </div>
            <span class="temp-value" th:text="${userDetails.mannerTemperature} + '°C'">36.5°C</span>
          </div>
        </div>

        <!-- 수정 버튼 (본인 프로필일 때만) -->
        <div class="profile-actions" th:if="${isOwnProfile}">
          <a th:href="@{/profile/edit}" class="btn btn-edit">프로필 수정</a>
        </div>
      </div>

      <!-- 프로필 상세 정보 -->
      <div class="profile-details">
        <div class="detail-section">
          <h3>소개</h3>
          <p th:if="${userDetails.introduction}" th:text="${userDetails.introduction}">자기소개가 있습니다.</p>
          <p th:unless="${userDetails.introduction}" class="empty-text">아직 자기소개를 작성하지 않았습니다.</p>
        </div>

        <div class="detail-section">
          <h3>기본 정보</h3>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">나이</span>
              <span class="info-value" th:text="${userDetails.age != null ? userDetails.age + '세' : '미공개'}">미공개</span>
            </div>
            <div class="info-item">
              <span class="info-label">성별</span>
              <span class="info-value" th:text="${userDetails.gender != null ? userDetails.gender.description : '미공개'}">미공개</span>
            </div>
          </div>
        </div>
      </div>

      <!-- 판매중인 상품 -->
      <div class="products-section">
        <h3 th:text="${isOwnProfile ? '내가 판매중인 상품' : user.userName + '님의 판매상품'}">판매중인 상품</h3>

        <div class="products-grid" th:if="${!userProducts.isEmpty()}">
          <div class="product-card" th:each="product : ${userProducts}">
            <a th:href="@{/products/{id}(id=${product.id})}" class="product-link">
              <div class="product-image">
                <img th:src="${product.images.size() > 0 ? product.images[0].image : '/images/default-product.jpg'}"
                     th:alt="${product.title}">
              </div>
              <div class="product-info">
                <h4 class="product-title" th:text="${product.title}">상품명</h4>
                <p class="product-price" th:text="${#numbers.formatInteger(product.price, 0, 'COMMA')} + '원'">가격</p>
                <p class="product-location" th:text="${product.location}">위치</p>
                <div class="product-meta">
                  <span class="product-views" th:text="'조회 ' + ${product.viewCount}">조회수</span>
                  <span class="product-date" th:text="${#temporals.format(product.createdAt, 'MM/dd')}">등록일</span>
                </div>
              </div>
            </a>
          </div>
        </div>

        <div class="empty-products" th:if="${userProducts.isEmpty()}">
          <p th:text="${isOwnProfile ? '아직 등록한 상품이 없습니다.' : '등록된 상품이 없습니다.'}">상품이 없습니다.</p>
          <a th:if="${isOwnProfile}" th:href="@{/products/new}" class="btn btn-register">상품 등록하기</a>
        </div>
      </div>
    </div>
  </section>
</main>

<!--* 공통 푸터 *-->
<div th:replace="~{fragments/footer :: common-footer}"></div>
</body>
</html>